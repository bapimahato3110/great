private static void scanNavigationMenuConfig(Path file, List<Result> results) throws IOException {

    Pattern menuConfigStart =
            Pattern.compile("MENU_CONFIGURATION\\s*=\\s*\\{");

    Pattern menuPattern =
            Pattern.compile("^\\s*([a-zA-Z0-9_]+)\\s*:\\s*\\{");

    Pattern rootPattern =
            Pattern.compile("^\\s*root\\s*:\\s*\\{");

    Pattern submenuBlockPattern =
            Pattern.compile("^\\s*submenu\\s*:\\s*\\{");

    Pattern submenuItemPattern =
            Pattern.compile("^\\s*([a-zA-Z0-9_]+)\\s*:\\s*\\{");

    Pattern rolesPattern =
            Pattern.compile("rolesAllowed\\s*:\\s*\\[(.*?)\\]");

    boolean insideMenuConfig = false;

    String currentMenu = null;
    String currentSection = null;
    String currentSubmenu = null;

    int braceDepth = 0;
    int menuConfigDepth = -1;

    List<String> lines = Files.readAllLines(file);

    for (String line : lines) {

        // --- detect MENU_CONFIGURATION start ---
        if (!insideMenuConfig) {
            if (menuConfigStart.matcher(line).find()) {
                insideMenuConfig = true;
                menuConfigDepth = braceDepth;
            }
        }

        // count braces AFTER detection
        braceDepth += countChar(line, '{');
        braceDepth -= countChar(line, '}');

        // --- exit MENU_CONFIGURATION ---
        if (insideMenuConfig && braceDepth <= menuConfigDepth) {
            insideMenuConfig = false;
            currentMenu = null;
            currentSection = null;
            currentSubmenu = null;
            continue;
        }

        if (!insideMenuConfig) {
            continue;
        }

        // --- menu name (instrumentManager / prc / qis) ---
        Matcher menuMatcher = menuPattern.matcher(line);
        if (menuMatcher.matches()
                && !"root".equals(menuMatcher.group(1))
                && !"submenu".equals(menuMatcher.group(1))) {

            currentMenu = menuMatcher.group(1);
            currentSection = null;
            currentSubmenu = null;
            continue;
        }

        // --- root ---
        if (rootPattern.matcher(line).matches()) {
            currentSection = "root";
            currentSubmenu = null;
            continue;
        }

        // --- submenu block ---
        if (submenuBlockPattern.matcher(line).matches()) {
            currentSection = "submenu";
            continue;
        }

        // --- submenu item ---
        if ("submenu".equals(currentSection)) {
            Matcher subMatcher = submenuItemPattern.matcher(line);
            if (subMatcher.matches()) {
                currentSubmenu = subMatcher.group(1);
                continue;
            }
        }

        // --- rolesAllowed ---
        Matcher rolesMatcher = rolesPattern.matcher(line);
        if (rolesMatcher.find() && currentMenu != null) {

            String[] roles = rolesMatcher.group(1)
                    .replace("\"", "")
                    .split(",");

            for (String role : roles) {
                role = role.trim();

                String assignedTo;
                if ("root".equals(currentSection)) {
                    assignedTo = currentMenu + " → root";
                } else {
                    assignedTo = currentMenu + " → " + currentSubmenu;
                }

                results.add(new Result(
                        file.getFileName().toString(),
                        assignedTo,
                        role,
                        "NA"
                ));
            }
        }
    }
}
